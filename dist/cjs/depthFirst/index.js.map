{"version":3,"sources":["index.js"],"sourcesContent":["const createEntry = require('./createEntry');\nconst filter = require('./filter');\nconst stat = require('./stat');\nconst fsCompat = require('../fs-compat');\nconst lifoFromArray = require('../lifoFromArray');\n\nfunction isDirectory(entry) {\n  if (entry.realStats) return entry.realStats.isDirectory();\n  return entry.stats.isDirectory();\n}\n\nmodule.exports = function path(item, iterator, callback) {\n  const depth = item.depth;\n  const entry = createEntry(iterator, item);\n  item = null; // release reference\n\n  stat(iterator, entry, function statCallback(err) {\n    if (err || iterator.done) return callback(err);\n\n    filter(iterator, entry, function filterCallback(err, keep) {\n      if (err || !keep || iterator.done) return callback(err);\n\n      // not a directory or is a directory, but next level is too deep\n      if (!isDirectory(entry) || depth + 1 > iterator.options.depth) return callback(null, entry);\n\n      // get files in this directory\n      fsCompat.readdir(entry.fullPath, iterator.options.readdir, function readdirCallback(err, files) {\n        if (err || iterator.done) return callback(err);\n        if (files.length) iterator.push({ path: entry.path, depth: depth + 1, files: lifoFromArray(files) });\n        return callback(null, entry);\n      });\n    });\n  });\n};\n"],"names":["createEntry","require","filter","stat","fsCompat","lifoFromArray","isDirectory","entry","realStats","stats","module","exports","path","item","iterator","callback","depth","statCallback","err","done","filterCallback","keep","options","readdir","fullPath","readdirCallback","files","length","push"],"mappings":";AAAA,IAAMA,cAAcC,QAAQ;AAC5B,IAAMC,SAASD,QAAQ;AACvB,IAAME,OAAOF,QAAQ;AACrB,IAAMG,WAAWH,QAAQ;AACzB,IAAMI,gBAAgBJ,QAAQ;AAE9B,SAASK,YAAYC,KAAK;IACxB,IAAIA,MAAMC,SAAS,EAAE,OAAOD,MAAMC,SAAS,CAACF,WAAW;IACvD,OAAOC,MAAME,KAAK,CAACH,WAAW;AAChC;AAEAI,OAAOC,OAAO,GAAG,SAASC,KAAKC,IAAI,EAAEC,QAAQ,EAAEC,QAAQ;IACrD,IAAMC,QAAQH,KAAKG,KAAK;IACxB,IAAMT,QAAQP,YAAYc,UAAUD;IACpCA,OAAO,MAAM,oBAAoB;IAEjCV,KAAKW,UAAUP,OAAO,SAASU,aAAaC,GAAG;QAC7C,IAAIA,OAAOJ,SAASK,IAAI,EAAE,OAAOJ,SAASG;QAE1ChB,OAAOY,UAAUP,OAAO,SAASa,eAAeF,GAAG,EAAEG,IAAI;YACvD,IAAIH,OAAO,CAACG,QAAQP,SAASK,IAAI,EAAE,OAAOJ,SAASG;YAEnD,gEAAgE;YAChE,IAAI,CAACZ,YAAYC,UAAUS,QAAQ,IAAIF,SAASQ,OAAO,CAACN,KAAK,EAAE,OAAOD,SAAS,MAAMR;YAErF,8BAA8B;YAC9BH,SAASmB,OAAO,CAAChB,MAAMiB,QAAQ,EAAEV,SAASQ,OAAO,CAACC,OAAO,EAAE,SAASE,gBAAgBP,GAAG,EAAEQ,KAAK;gBAC5F,IAAIR,OAAOJ,SAASK,IAAI,EAAE,OAAOJ,SAASG;gBAC1C,IAAIQ,MAAMC,MAAM,EAAEb,SAASc,IAAI,CAAC;oBAAEhB,MAAML,MAAMK,IAAI;oBAAEI,OAAOA,QAAQ;oBAAGU,OAAOrB,cAAcqB;gBAAO;gBAClG,OAAOX,SAAS,MAAMR;YACxB;QACF;IACF;AACF"}